<?php define("SMS_CONTROLER_URL", DIR_APPLICATION . 'model/sms/'); require_once (defined("SMS_CONTROLER_URL")?SMS_CONTROLER_URL:"") .'smsController.php'; class ControllerSmsSend extends SmsController { public $text = ""; public $unicode = false; public $unique = true; public $timezone = array(); public $sendlater = false; public $recipients = ""; public $coupon = -1; public $laterDate; public $saveName = ""; public $datereal = 0; public $store = 0; public function index() { $this->setAjaxPostAction("smsCounter();"); parent::index(); } public function ajaxSaveTemplate() { $this->disableScrollUp(); $this->sendSnippet("popuphead", v_template_save); $this->sendSnippet("popupcontent", $this->f473f9812f802efbdb2dc40177774120ea42ffde3()); } public function ajaxLoadTemplate() { $this->disableScrollUp(); $this->sendSnippet("popuphead", v_template_load); $this->sendSnippet("popupcontent", $this->f473f9812f802efbdb2dc40177774120ea42ffde3(false)); } public function ajaxDeleteSaveTemplate($iced8cbcfca3c880f0f157e119d1cc6f8691e7e89) { $this->disableScrollUp(); $this->Execute("DELETE FROM `" . DB_PREFIX . "sp_template` WHERE `id` = '" . $this->escape($iced8cbcfca3c880f0f157e119d1cc6f8691e7e89["template"]) . "'"); $this->sendSnippet("popupcontent", $this->f473f9812f802efbdb2dc40177774120ea42ffde3(false)); } public function ajaxRestoreTemplate($iced8cbcfca3c880f0f157e119d1cc6f8691e7e89) { $ic6e936002fe51b97bc1b95f337c09606ceb011de = $this->Execute("SELECT * FROM `" . DB_PREFIX . "sp_template` WHERE `id` = '" . $this->escape($iced8cbcfca3c880f0f157e119d1cc6f8691e7e89["template"]) . "'"); if($ic6e936002fe51b97bc1b95f337c09606ceb011de->num_rows) { $this->sendSnippet("textarea", self::getTextArea(array("name" => "text", "onchange" => "smsCounter()", "onkeyup" => "smsCounter()", "rows" => 12, "cols" => 60, "class" => "left", "id" => "smsText"), $ic6e936002fe51b97bc1b95f337c09606ceb011de->row["template"])); $this->sendSnippet("unicode", self::getInput(array("type" => "checkbox", "onchange" => "smsCounter()", "id" => "unicode", "name" => "unicode", "value" => 1), $ic6e936002fe51b97bc1b95f337c09606ceb011de->row["unicode"]) . ' ' . v_smsmarketing_unicode . ' ' . self::getHint(v_smsmarketing_unicodetext)); $this->sendSnippet("unique", self::getInput(array("type" => "checkbox", "id" => "unique", "name" => "unique", "value" => 1), $ic6e936002fe51b97bc1b95f337c09606ceb011de->row["unique"]) . ' ' . v_remove_duplicate); $this->_okMsg[] = v_template_been_apply; } } public function ajaxAddressBook($iced8cbcfca3c880f0f157e119d1cc6f8691e7e89) { $this->disableScrollUp(); $this->sendSnippet("popuphead", "<img src=\"" . self::$adminEmployeesImg . "\"> " . v_sendsms_addrecipients); $this->sendSnippet("popupcontent", $this->f9cb875d3870e48e6020c8f5cbb096080736dd94b($iced8cbcfca3c880f0f157e119d1cc6f8691e7e89["letter"])); } public function display() { $iae8c74e5273dec25096dbae362493a9f609ecfc8 = parent::display(); $i84bc545bbb2cff247d6ae6400af05eeb443267d9 = $this->getCoupons(); if(function_exists ("filter_input")) { $i2fb7b08d75ddb5bf1383929c82f63cb5beaca6da = filter_input(INPUT_GET, "recipient", FILTER_SANITIZE_STRING); $iab6a314decb74f5c532ecb082cfeb1655b9e98bb = filter_input(INPUT_GET, "country", FILTER_SANITIZE_STRING); } else { $i2fb7b08d75ddb5bf1383929c82f63cb5beaca6da = $_GET["recipient"]; $iab6a314decb74f5c532ecb082cfeb1655b9e98bb = $_GET["country"]; } if(($this->recipients == "") && ($i2fb7b08d75ddb5bf1383929c82f63cb5beaca6da != null && $iab6a314decb74f5c532ecb082cfeb1655b9e98bb != null)) { $i4367816f1ae76ddc44b3953c9ce6460e181a0a3a = new SmsModel($this->getDb()); $this->recipients = $i4367816f1ae76ddc44b3953c9ce6460e181a0a3a->number($i2fb7b08d75ddb5bf1383929c82f63cb5beaca6da, 0, 0, $iab6a314decb74f5c532ecb082cfeb1655b9e98bb)->getNumber() . ", "; } elseif(($this->recipients == "") && ($i2fb7b08d75ddb5bf1383929c82f63cb5beaca6da != null)) { $this->recipients = $i2fb7b08d75ddb5bf1383929c82f63cb5beaca6da . ", "; } $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= ' <script type="text/javascript"> var v_smsmarketing_longtext = "' . v_smsmarketing_longtext . '"; var v_smsmarketing_jstotalcustomers = "' . v_smsmarketing_jstotalcustomers . '"; var v_smsmarketing_jstotalsms = "' . v_smsmarketing_jstotalsms . '"; var v_smsmarketing_jschars = "' . v_smsmarketing_jschars . '"; var v_smsanswers_sms = "' . v_smsanswers_sms . '"; </script> '; $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= '<h2>' . v_sendsms_sendsms . '</h2> <p>' . v_sendsms_sendtext . '</p>'; $if429efc5a59c5e838378c1af65309e5e9550c9de = $this->getTimezoneSettings(); $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= $this->getTemplateRepalce(); $i738fb66ac1450318a6afd838e3ce268b59e35f75 = new DateTime($this->laterDate); $i738fb66ac1450318a6afd838e3ce268b59e35f75->setTimezone(new DateTimeZone($this->timezone));  $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= "<script type=\"text/javascript\" src=\"" . DIR_SMS_JS . "sms.js\"></script>"; $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= '<script type="text/javascript" src="' . DIR_SMS_JS . 'jquery.at.caret.min.js"></script>'; $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= ' <form name="formSMS" action="" method="post" enctype="multipart/form-data"> <fieldset> ' . Html::legend(Html::img(array("src" => self::$transImg)) . " " . v_sendsms_bulksms . "<span class=\"right\"><a href=\"" .$this->smsLinkSaveTemplate(). "\" class=\"ajax\" onclick=\"showPopup();\">[" . v_template_save . "]</a> <a href=\"" .$this->smsLinkSavedTemplate(). "\" class=\"ajax\" onclick=\"showPopup();\">[" . v_template_load . "]</a></span>") . ' <table class="formTableSend"> <tbody> <tr> <td>' . v_smsmarketing_entertext . ':</td> <td>' . v_adminsms_preview . ': <span id="labelSMS" class="note s12 right"></span></td> <td></td> </tr> <tr> <td rowspan=4 class="sendTextArea" id="snippet-textarea">' . self::getTextArea(array("name" => "text", "onchange" => "smsCounter()", "onkeyup" => "smsCounter()", "rows" => 12, "cols" => 60, "class" => "left", "id" => "smsText"), $this->text) . '</td> <td rowspan=4 class="sendTextArea">' . self::getTextArea(array("name" => "preview", "rows" => 12, "cols" => 60, "class" => "left", "id" => "smsPreview", "disabled" => "disabled")) . '</td> <td id="snippet-unicode">' . self::getInput(array("type" => "checkbox", "onchange" => "smsCounter()", "id" => "unicode", "name" => "unicode", "value" => 1), $this->unicode) . ' ' . v_smsmarketing_unicode . ' ' . self::getHint(v_smsmarketing_unicodetext) . '</td> </tr> <tr> <td id="snippet-unique">' . self::getInput(array("type" => "checkbox", "id" => "unique", "name" => "unique", "value" => 1), $this->unique) . ' ' . v_remove_duplicate . '</td> </tr> <tr> <td>' . self::getInput(array("type" => "checkbox", "id" => "sendlater", "name" => "sendlater", "value" => 1, "onclick" => "jQuery('.sendLater').toggleClass('invisibility');"), $this->sendlater) . ' ' . v_smsmarketing_sendlater . '</td> </tr> <tr> <td> <table class="sendLater ' . (($this->sendlater == 1) ? ("") : ("invisibility")) . '"> <tr> <td>' . v_smsmarketing_date . '</td> <td>' . self::getInput(array("type" => "text", "id" => "datetimepicker", "class" => "datetime", "name" => "laterdate")) . '</td> </tr> <tr> <td>' . v_smsmarketing_yourtime . '</td> <td>' . self::getSelect(array("name" => "datereal"), array(-1 => $if429efc5a59c5e838378c1af65309e5e9550c9de . " -" . v_smsmarketing_hr, 0 => $if429efc5a59c5e838378c1af65309e5e9550c9de, 1 => $if429efc5a59c5e838378c1af65309e5e9550c9de . " +" . v_smsmarketing_hr), $this->datereal) . '</td> </tr> <tr> <td></td> <td>(' . v_smsmarketing_timezone . '<a href="' . $this->smsLinkTimezone() . '">' . $this->timezone . '</a>)</td> </tr> </table> </td> </tr> <tr> <td colspan="2"><p>' . v_smsprestashop_notice . '</p> <p>' . $this->getStoreForm($this->store) . " " . $this->getTags(self::$MarketingTemplateShop) . '<p/> ' . $this->getCouponForm($i84bc545bbb2cff247d6ae6400af05eeb443267d9, $this->coupon) . ' </td> <td class="bottom"></td> </tr> </tbody> </table> </fieldset> <fieldset> ' . Html::legend(Html::img(array("src" => self::$adminCustomerImg)) . ' ' . v_sendsms_addrecipients . ' ' . self::getHint(v_sendsms_addtext) . ' ' . v_sendsms_eg) . ' <table class="formTableSend"> <tbody> <tr> <td class="sendTextArea" rowspan="4">' . self::getTextArea(array("name" => "recipients", "id" => "recipients", "cols" => 80, "rows" => 8), $this->recipients) . '</td> <td> ' . v_sendsms_addcsv_vcard . ' ' . self::getHint(v_sendsms_csvtext) . '</td> </tr> <tr> <td class="top">' . self::getInput(array("type" => "file", "name" => "sms_file")) . '</td> </tr> <tr> <td><h3> <img src="' . self::$adminEmployeesImg . '" alt="" /> <a href="' .$this->smsLinkAddressBook(). '" class="ajax" onclick="showPopup();">' . v_sendsms_addrecipients . '</a></h3></td> </tr> <tr> <td></td> </tr> <tr> <td></td> <td class="top">' . self::getInput(array("type" => "submit", "name" => "submitSendSmsSendSMS", "value" => v_smsmarketing_send, "class" => "button", "onclick" => "return confirmSend('" . v_smsmarketing_send . "', '" . v_smsanswers_sms . "');")) . '</td> </tr> </tbody> </table> </fieldset> </form> '; if(defined("SMS_CLOSE_SYMBOL")) { $if4a22975defb18dcde9f11b9d3783f045bc15a73 = SMS_CLOSE_SYMBOL; } else { $if4a22975defb18dcde9f11b9d3783f045bc15a73 = "Ã—"; } $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= ' <div id="popup"> <p class="popuphead"> <span id="snippet-popuphead"></span> <span class="close right" onclick="showPopup();">'.$if4a22975defb18dcde9f11b9d3783f045bc15a73.'</span> </p> <div class="popupcontent"> <p id="snippet-popupcontent"></p> </div> </div> <div id="popupbackground"></div> '; $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= self::getAjaxLoader("submitSend", "<div id=\"smsloader\"><h3>" . v_send_busy . "</h3><br/><img src=\"" . self::$busy . "\" /></div><div id=\"smsloaderbackground\"></div>"); $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= " <script type=\"text/javascript\"> jQuery('#datetimepicker').datetimepicker({ lang:'" . lang_iso_code . "', value:'" . $i738fb66ac1450318a6afd838e3ce268b59e35f75->format("Y-m-d H:i") . "' }); smsCounter(); toggleCouponVariables(); </script> "; return $iae8c74e5273dec25096dbae362493a9f609ecfc8; } public function postProcess($icddcd508600972f2dab78cd14f7612aa4dc19a18 = NULL, $i6b496fee24729ce6f7683ba88d5a87d6130049b5 = NULL, $ifab26c5df1e4ac29b64e0a4796b1f9165fe614a8 = NULL) { if($icddcd508600972f2dab78cd14f7612aa4dc19a18 == NULL && $i6b496fee24729ce6f7683ba88d5a87d6130049b5 == NULL) { return self::POST_ERROR; } if(isset($icddcd508600972f2dab78cd14f7612aa4dc19a18['submitSendSmsSendSMS'])) { $this->unicode = $this->escapePostVariables("unicode"); $this->unique = $this->escapePostVariables("unique"); $this->sendlater = $this->escapePostVariables("sendlater"); $this->laterDate = $this->escapePostVariables("laterdate"); $this->text = $this->escapePostVariables("text"); $this->datereal = $this->escapePostVariables("datereal"); $this->coupon = $this->escapePostVariables("coupon"); $this->recipients = $this->escapePostVariables("recipients"); $this->store = $this->escapePostVariables("store"); $this->text = $this->applyTemplate($this->getShopVariables($this->store), $this->text, self::$MarketingTemplateShop); if($this->coupon != -1) { $this->text = $this->applyTemplate($this->getCouponData($this->coupon), $this->text, self::$MarketingTemplateCoupons); } $i4367816f1ae76ddc44b3953c9ce6460e181a0a3a = new SmsModel($this->getDb(), SmsModel::TYPE_SIMPLE, SmsModel::SMS_CTYPE_CUSTOMER, SmsModel::SMS_BULK); if($_FILES['sms_file']["error"] == UPLOAD_ERR_OK) { $i06493fffaa8df28d7e93ecadf0456d1c6ef2dd59 = array('application/vnd.ms-excel', 'text/plain', 'text/csv', 'text/tsv'); if(in_array($_FILES['sms_file']['type'], $i06493fffaa8df28d7e93ecadf0456d1c6ef2dd59)) { $iced8cbcfca3c880f0f157e119d1cc6f8691e7e89 = file_get_contents($_FILES['sms_file']['tmp_name']); if(strlen($iced8cbcfca3c880f0f157e119d1cc6f8691e7e89) > 0) { $i6759260164586078a2fa1aa45098abd39b1b024f = explode("\n", $iced8cbcfca3c880f0f157e119d1cc6f8691e7e89); foreach($i6759260164586078a2fa1aa45098abd39b1b024f as $i43ef5aef4168652439ef5de195405ced9f0f7952) { $i54fc95c620615b8e68df386b72929d1208bad191 = explode(";", $i43ef5aef4168652439ef5de195405ced9f0f7952); if(strlen($i54fc95c620615b8e68df386b72929d1208bad191[0]) > 0) { $i9b6c9cca0694350eee34e46f63f570fa8cb734eb[] = $i54fc95c620615b8e68df386b72929d1208bad191[0]; } } } else { $icae5bf8f5bd9daa6fdb6df264202125d19c6d430 = FOpen($_FILES['sms_file']['tmp_name'], "r"); if($icae5bf8f5bd9daa6fdb6df264202125d19c6d430 != null) { while($iced8cbcfca3c880f0f157e119d1cc6f8691e7e89 = FGets($icae5bf8f5bd9daa6fdb6df264202125d19c6d430, 5000)) { $ief7afdabf057a5931e499c7cbab3c17ceceb7e37 = explode(";", $iced8cbcfca3c880f0f157e119d1cc6f8691e7e89); if(strlen($i54fc95c620615b8e68df386b72929d1208bad191[0]) > 0) { $i9b6c9cca0694350eee34e46f63f570fa8cb734eb[] = $ief7afdabf057a5931e499c7cbab3c17ceceb7e37[0]; } } } } } elseif($_FILES['sms_file']['type'] == "text/x-vcard" || $_FILES['sms_file']['type'] == "text/vcard") { $i9b6c9cca0694350eee34e46f63f570fa8cb734eb = preg_replace("/TEL;.*:/", "", preg_grep("/TEL;/", explode("\n", file_get_contents($_FILES['sms_file']['tmp_name'] )))); } else { $this->_errors[] = v_sendsms_csvtext; return self::POST_ERROR; } $i4367816f1ae76ddc44b3953c9ce6460e181a0a3a->number($i9b6c9cca0694350eee34e46f63f570fa8cb734eb); } if($this->unicode) { $i4367816f1ae76ddc44b3953c9ce6460e181a0a3a->unicode(); } if($this->unique) { $i4367816f1ae76ddc44b3953c9ce6460e181a0a3a->unique(); } if($this->sendlater) { $this->getTimezoneSettings(); $id9fa4635372c4216f6d8a98e38c0b7d89c775790 = new DateTime($this->laterDate); $id9fa4635372c4216f6d8a98e38c0b7d89c775790->setTimezone(new DateTimeZone($this->timezone)); $id9fa4635372c4216f6d8a98e38c0b7d89c775790->modify($this->datereal . " hour"); $i4367816f1ae76ddc44b3953c9ce6460e181a0a3a->sendLater($id9fa4635372c4216f6d8a98e38c0b7d89c775790); } $i4367816f1ae76ddc44b3953c9ce6460e181a0a3a->number($this->recipients)->text($this->text)->send(); if($i4367816f1ae76ddc44b3953c9ce6460e181a0a3a->isError()) { $this->_errors = array_unique($i4367816f1ae76ddc44b3953c9ce6460e181a0a3a->getErrors()); return self::POST_ERROR; } else { $this->_okMsg = array_unique($i4367816f1ae76ddc44b3953c9ce6460e181a0a3a->getConfirm()); return self::POST_OK; } } elseif(isset($icddcd508600972f2dab78cd14f7612aa4dc19a18["saveTemplate"])) { $this->saveName = $this->escapePostVariables("saveName"); $iccc7124c4929a783f68681205060c9cffb230624 = $this->escapePostVariables("saveText"); $ia16b8bee9a5a69d4ec369fae234a70efdd002c24 = $this->escapePostVariables("saveUnicode"); $ia74439b5a1382238828ba4fcd21ede60406b1de2 = $this->escapePostVariables("saveUnique"); $ia16b8bee9a5a69d4ec369fae234a70efdd002c24 = ($ia16b8bee9a5a69d4ec369fae234a70efdd002c24 == "true") ? 1 : 0; $ia74439b5a1382238828ba4fcd21ede60406b1de2 = ($ia74439b5a1382238828ba4fcd21ede60406b1de2 == "true") ? 1 : 0; $this->Execute("INSERT INTO `" . DB_PREFIX . "sp_template` (`name`, `template`, `unicode`, `unique`, `date`, `type`) VALUES ('" . $this->escape($this->saveName) . "', '" . $this->escape($iccc7124c4929a783f68681205060c9cffb230624) . "', '" . $this->escape($ia16b8bee9a5a69d4ec369fae234a70efdd002c24) . "', '" . $this->escape($ia74439b5a1382238828ba4fcd21ede60406b1de2) . "', NOW(), '1')"); $this->_okMsg[] = v_template_been_saved; return self::POST_OK; } return self::POST_ERROR; } private function f16d697d25053958ee168fb54b35c80e6ced84028() { $i70f6f71830b6ec971e941dbd23cb209a47364720 = '<h3 class="center">'; $i77f9253b6cc185646f4f695f164ead4ae85b6540 = explode(";", lang_alphabet); foreach($i77f9253b6cc185646f4f695f164ead4ae85b6540 as $ib584f54a0be935f7ee8332f9a65155eb2870a7be) { $i70f6f71830b6ec971e941dbd23cb209a47364720 .= ' <a href="'.$this->smsLinkAddressBook($ib584f54a0be935f7ee8332f9a65155eb2870a7be).'" class="ajax">'.$ib584f54a0be935f7ee8332f9a65155eb2870a7be.'</a>'; } $i70f6f71830b6ec971e941dbd23cb209a47364720 .= "</h3>"; return $i70f6f71830b6ec971e941dbd23cb209a47364720; } private function f473f9812f802efbdb2dc40177774120ea42ffde3($i2649b9597db10189fdaf013de24c6ec5e8949dab = true) { $iae8c74e5273dec25096dbae362493a9f609ecfc8 = ""; if($i2649b9597db10189fdaf013de24c6ec5e8949dab) { $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= ' <form name="saveFilter" action="" method="post" class="ajax hoverForm"> <table> <tr> <td>' . v_template_name . ': ' . self::getInput(array("name" => "saveName", "type" => "text")) . ' ' . self::getInput(array("name" => "saveText", "id" => "smsSaveTemplate", "type" => "hidden")) . ' ' . self::getInput(array("name" => "saveUnicode", "id" => "smsSaveTemplateUnicode", "type" => "hidden")) . ' ' . self::getInput(array("name" => "saveUnique", "id" => "smsSaveTemplateUnique", "type" => "hidden")) . ' ' . self::getInput(array("name" => "saveTemplate", "type" => "submit", "value" => v_template_save, "onclick" => "showPopup();")) . ' <script type="text/javascript"> jQuery("#smsSaveTemplate").val(jQuery("#smsText").val()); jQuery("#smsSaveTemplateUnicode").val(jQuery("#unicode").is(":checked")); jQuery("#smsSaveTemplateUnique").val(jQuery("#unique").is(":checked")); </script> </td> </tr> </table> </form> </br> <h2>' . v_template_load . '</h2> '; } $ic6e936002fe51b97bc1b95f337c09606ceb011de = $this->Execute("SELECT * FROM `" . DB_PREFIX . "sp_template` WHERE type = 1 ORDER BY date DESC"); if($ic6e936002fe51b97bc1b95f337c09606ceb011de->num_rows) { $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= "<table class=\"resultTable\"> <thead> <tr> <th>" . v_template_name . "</th> <th>" . v_filter_date . "</th> <th></th> </tr> </thead> <tbody> "; foreach($ic6e936002fe51b97bc1b95f337c09606ceb011de->rows as $i43ef5aef4168652439ef5de195405ced9f0f7952) { $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= " <tr " . self::isEven($if3b517d335a2b4ef26a37d2656c41c234b2a734a, "even") . "> <td><a href=\"" . $this->smsLinkRestoreTemplate($i43ef5aef4168652439ef5de195405ced9f0f7952["id"]) . "\" class=\"ajax\" onclick=\"showPopup();\">" . $i43ef5aef4168652439ef5de195405ced9f0f7952["name"] . "</a></td> <td class=\"w150\">" . $i43ef5aef4168652439ef5de195405ced9f0f7952["date"] . "</td> <td class=\"w20\"><a href=\"" . $this->smsLinkDeleteTemplate($i43ef5aef4168652439ef5de195405ced9f0f7952["id"]) . "\" class=\"ajax\" data-confirm=\"" . v_template_q_delete . "\"><img src=\"" . self::$adminDelete . "\" /></a></td> </tr>"; } $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= "</tbody></table>"; } else { $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= self::getNote(v_template_not_found); } return $iae8c74e5273dec25096dbae362493a9f609ecfc8; } private function f9cb875d3870e48e6020c8f5cbb096080736dd94b($ib584f54a0be935f7ee8332f9a65155eb2870a7be = "A") { if($ib584f54a0be935f7ee8332f9a65155eb2870a7be == null) { $ib584f54a0be935f7ee8332f9a65155eb2870a7be = "A"; } $iae8c74e5273dec25096dbae362493a9f609ecfc8 = $this->f16d697d25053958ee168fb54b35c80e6ced84028(); $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= "<div class=\"center\">" . self::getAjaxLoader("addressBook", "<img src=\"" . self::$busy . "\">") . "</div>"; $ic6e936002fe51b97bc1b95f337c09606ceb011de = $this->Execute($this->getAddressBook($ib584f54a0be935f7ee8332f9a65155eb2870a7be)); if($ic6e936002fe51b97bc1b95f337c09606ceb011de->num_rows) { $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= "<table class=\"resultTable\"> <thead> <tr> <th></th> <th>" . v_smsmarketing_allcustomers . " - " . $ib584f54a0be935f7ee8332f9a65155eb2870a7be . "</th> <th>" . v_smsmarketing_mobilenr . "</th> </tr> </thead> <tbody> "; foreach($ic6e936002fe51b97bc1b95f337c09606ceb011de->rows as $i43ef5aef4168652439ef5de195405ced9f0f7952) { $i9110e9381bd52d5eb5c5fe59bf358843f431b8ee = new PhoneNumber($this->getDb(), $i43ef5aef4168652439ef5de195405ced9f0f7952["telephone"], SmsModel::SMS_CTYPE_CUSTOMER, $i43ef5aef4168652439ef5de195405ced9f0f7952["customer_id"], 0, $i43ef5aef4168652439ef5de195405ced9f0f7952["country_id"], $i43ef5aef4168652439ef5de195405ced9f0f7952["city"]); $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= " <tr " . self::isEven($if3b517d335a2b4ef26a37d2656c41c234b2a734a, "even") . "> <td class=\"w20\"><img src=\"" . self::$sendImg . "\"></td> <td><span class=\"variables\" data=\"" . $i9110e9381bd52d5eb5c5fe59bf358843f431b8ee->mobile . "\" onclick=\"addRecipient('" . $i9110e9381bd52d5eb5c5fe59bf358843f431b8ee->mobile . "');\">" . $i43ef5aef4168652439ef5de195405ced9f0f7952["lastname"] . " " . $i43ef5aef4168652439ef5de195405ced9f0f7952["firstname"] . "</td> <td class=\"w150\">+" . $i9110e9381bd52d5eb5c5fe59bf358843f431b8ee->mobile . "</td> </tr>"; } $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= "</tbody></table>"; } else { $iae8c74e5273dec25096dbae362493a9f609ecfc8 .= "<h3 class=\"center\"><img src=\"" . self::$denyImg . "\"> <strong>" . $ib584f54a0be935f7ee8332f9a65155eb2870a7be . "</strong> " . v_smsprestashop_notfound . "</h3>"; } if(defined("SMS_CLOSE_SYMBOL")) { $iae8c74e5273dec25096dbae362493a9f609ecfc8 = preg_replace('/[\x00-\x1F\x80-\xFF]/', '', $iae8c74e5273dec25096dbae362493a9f609ecfc8); } return $iae8c74e5273dec25096dbae362493a9f609ecfc8; } } 